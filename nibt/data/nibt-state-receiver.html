<link rel="import" href="bower_components/polymer/polymer.html">

<polymer-element name="nibt-state-receiver" attributes="url sameHostPath">
  <template>
  </template>

  <script>
    Polymer({
      ws: null, 
      url: null,
      sameHostPath: null,
      ready: function(){
        if (this.sameHostPath !== null){
          this.ws = new WebSocket("ws://"+window.location.host+this.sameHostPath);
        } else if (this.url !== null){
          this.ws = new WebSocket(this.url);
        } else {
          throw "url or sameHostPath must be set";
        }
        this.ws.onmessage = this.onMessage.bind(this);
      },
      onMessage: function(evt){
        var msg = JSON.parse(evt.data);
        this.fire(msg.sid+"-"+msg.type, msg.data);
      }
    });
  </script>
</polymer-element>
